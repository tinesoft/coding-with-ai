<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <style>
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #333; }
      .title { font-size: 20px; font-weight: bold; fill: #1e3a8a; }
      .step-box { fill: #f0f9ff; stroke: #3b82f6; stroke-width: 2; }
      .code { font-family: 'Courier New', monospace; font-size: 10px; fill: #333; }
      .arrow { stroke: #3b82f6; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6" />
    </marker>
  </defs>
  
  <text x="400" y="35" class="title" text-anchor="middle">AI-Assisted Refactoring Workflow</text>
  
  <!-- Step 1: Identify Issues -->
  <rect x="50" y="70" width="300" height="120" class="step-box" rx="8"/>
  <text x="200" y="95" class="text" text-anchor="middle" font-weight="bold" font-size="14">1. Identify Quality Issues</text>
  <rect x="70" y="105" width="260" height="70" fill="#fee2e2" stroke="#dc2626" stroke-width="1" rx="3"/>
  <text x="200" y="125" class="code" text-anchor="middle">function processData(d) {</text>
  <text x="200" y="140" class="code" text-anchor="middle">  if(d){if(d.length){for(let i=0;i&lt;d.length;i++){</text>
  <text x="200" y="155" class="code" text-anchor="middle">    console.log(d[i]); /* more nested code */}}}</text>
  <text x="200" y="170" class="code" text-anchor="middle">}</text>
  
  <!-- Arrow -->
  <path d="M 350 130 L 450 130" class="arrow"/>
  
  <!-- Step 2: AI Analysis -->
  <rect x="450" y="70" width="300" height="120" class="step-box" rx="8"/>
  <text x="600" y="95" class="text" text-anchor="middle" font-weight="bold" font-size="14">2. AI Analyzes Problems</text>
  <text x="600" y="120" class="text" text-anchor="middle" font-size="11">
    ✗ Poor naming (d, i)
  </text>
  <text x="600" y="140" class="text" text-anchor="middle" font-size="11">
    ✗ High complexity (nested ifs/loops)
  </text>
  <text x="600" y="160" class="text" text-anchor="middle" font-size="11">
    ✗ Missing type annotations
  </text>
  <text x="600" y="180" class="text" text-anchor="middle" font-size="11">
    ✗ Console.log in production code
  </text>
  
  <!-- Arrow down -->
  <path d="M 600 190 L 600 250" class="arrow"/>
  
  <!-- Step 3: AI Suggests Refactoring -->
  <rect x="450" y="250" width="300" height="140" class="step-box" rx="8"/>
  <text x="600" y="275" class="text" text-anchor="middle" font-weight="bold" font-size="14">3. AI Suggests Refactoring</text>
  <rect x="470" y="285" width="260" height="90" fill="#d1fae5" stroke="#10b981" stroke-width="1" rx="3"/>
  <text x="600" y="305" class="code" text-anchor="middle">function processDataItems(items: DataItem[]): void {</text>
  <text x="600" y="320" class="code" text-anchor="middle">  if (!items?.length) return;</text>
  <text x="600" y="335" class="code" text-anchor="middle">  items.forEach(item => logger.debug(item));</text>
  <text x="600" y="350" class="code" text-anchor="middle">}</text>
  <text x="600" y="370" class="text" text-anchor="middle" font-size="10" fill="#047857" font-weight="bold">
    ✓ Clear naming | ✓ Reduced complexity | ✓ Types | ✓ Proper logging
  </text>
  
  <!-- Arrow left -->
  <path d="M 450 320 L 350 320" class="arrow"/>
  
  <!-- Step 4: Verify Tests Pass -->
  <rect x="50" y="250" width="300" height="140" class="step-box" rx="8"/>
  <text x="200" y="275" class="text" text-anchor="middle" font-weight="bold" font-size="14">4. Verify Tests Still Pass</text>
  <rect x="70" y="285" width="260" height="90" fill="#d1fae5" stroke="#10b981" stroke-width="1" rx="3"/>
  <text x="200" y="315" class="text" text-anchor="middle" font-size="12">
    ✓ All unit tests pass
  </text>
  <text x="200" y="340" class="text" text-anchor="middle" font-size="12">
    ✓ Code coverage maintained: 85%
  </text>
  <text x="200" y="365" class="text" text-anchor="middle" font-size="12" font-weight="bold" fill="#047857">
    ✓ Refactoring successful!
  </text>
  
  <!-- Metrics Improvement Box -->
  <rect x="150" y="430" width="500" height="140" fill="#f9fafb" stroke="#d1d5db" stroke-width="1" rx="8"/>
  <text x="400" y="460" class="text" text-anchor="middle" font-weight="bold" font-size="14">Quality Metrics Improvement</text>
  
  <!-- Before/After Table -->
  <text x="250" y="485" class="text" font-weight="bold">Before</text>
  <text x="550" y="485" class="text" font-weight="bold">After</text>
  
  <text x="200" y="505" class="text">Complexity:</text>
  <text x="300" y="505" class="text" fill="#991b1b">12</text>
  <text x="600" y="505" class="text" fill="#047857">3 (↓ 75%)</text>
  
  <text x="200" y="525" class="text">Maintainability:</text>
  <text x="300" y="525" class="text" fill="#92400e">52</text>
  <text x="600" y="525" class="text" fill="#047857">78 (↑ 50%)</text>
  
  <text x="200" y="545" class="text">Code Smells:</text>
  <text x="300" y="545" class="text" fill="#991b1b">8</text>
  <text x="600" y="545" class="text" fill="#047857">1 (↓ 87.5%)</text>
</svg>
